generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DB_URL")
}

model User {
  id        String   @id @default(uuid()) @db.VarChar(255)
  firstName String?  @db.VarChar(255)
  lastName  String?  @db.VarChar(255)
  email     String   @unique(map: "User_UNIQUE") @db.VarChar(255)
  role      String?  @db.VarChar(255)
  isAdmin   Boolean  @default(false)
  Poster    Poster[]

  @@unique([firstName, lastName], map: "User_UN")
  @@index([email], map: "email")
}

model Device {
  MACaddress  String    @id @db.VarChar(255)
  deviceName  String?   @unique(map: "deviceName") @db.VarChar(255)
  room        String?   @db.VarChar(255)
  location    String?   @db.LongText
  description String?   @db.VarChar(255)
  status      Boolean   @default(false)
  Display     Display[]
}

model Poster {
  posterId    String    @unique(map: "posterId") @default(uuid()) @db.VarChar(255)
  id          String    @db.VarChar(255)
  title       String    @unique(map: "title") @db.VarChar(255)
  description String?   @db.VarChar(255)
  image       String    @db.LongText
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @default(now()) @updatedAt
  Display     Display[]
  User        User      @relation(fields: [id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "Poster_ibfk_2")

  @@id([posterId, id])
  @@index([id], map: "id")
}

model Display {
  MACaddress String   @db.VarChar(255)
  posterId   String   @db.VarChar(255)
  startDate  DateTime @db.Date
  endDate    DateTime @db.Date
  startTime  DateTime @db.Time(0)
  endTime    DateTime @db.Time(0)
  duration   Int
  Device     Device   @relation(fields: [MACaddress], references: [MACaddress], onDelete: NoAction, onUpdate: NoAction, map: "Display_ibfk_1")
  Poster     Poster   @relation(fields: [posterId], references: [posterId], onDelete: NoAction, onUpdate: NoAction, map: "Display_ibfk_2")

  @@id([MACaddress, posterId, startDate, endDate, startTime, endTime])
  @@index([MACaddress], map: "MACaddress")
  @@index([posterId], map: "posterId")
}

model Emergency {
  incidentName   String  @id @db.VarChar(255)
  emergencyImage String  @db.LongText
  description    String? @db.VarChar(255)
  status         Boolean @default(false)
}
